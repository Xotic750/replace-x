{"version":3,"sources":["../src/replace-x.js"],"names":[],"mappings":"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","file":"replace-x.js","sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport minimatch from 'minimatch';\nimport isUndefined from 'lodash/isUndefined';\nimport isRegex from 'is-regexp-x';\nimport isNull from 'lodash/isNull';\nimport xRegExp from 'xregexp';\nimport sharedOptionsFactory from '../bin/shared-options-x';\nimport 'colors';\n\nconst sharedOptions = sharedOptionsFactory();\n\nconst hasOwnProp = function hasOwnProp(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n};\n\nconst not = function not(value) {\n  return Boolean(value) === false;\n};\n\nconst isFalsey = function isFalsey(value) {\n  return not(value);\n};\n\nconst isStringType = function isStringType(value) {\n  return typeof value === 'string';\n};\n\nconst getFlags = function getFlags(options) {\n  let flags = 'g'; // global multiline\n\n  if (options.ignoreCase) {\n    flags += 'i';\n  }\n\n  if (options.multiline) {\n    flags += 'm';\n  }\n\n  if (options.unicode) {\n    flags += 'u';\n  }\n\n  return flags;\n};\n\nconst getRegExp = function getRegExp(options) {\n  if (isRegex(options.regex) || xRegExp.isRegExp(options.regex)) {\n    return options.regex;\n  }\n\n  return xRegExp(options.regex, getFlags(options));\n};\n\nconst getOptionList = function getOptionList(list, def) {\n  return list ? list.split(',') : def;\n};\n\nconst canSearch = function canSearch(file, isFile, options) {\n  const includes = getOptionList(options.include, null);\n  const ignoreFile = options.excludeList || path.join(__dirname, '/defaultignore');\n  const ignores = fs.readFileSync(ignoreFile, options.encoding).split('\\n');\n  const excludes = getOptionList(options.exclude, []).concat(ignores);\n  const inIncludes =\n    includes &&\n    includes.some(function iteratee(include) {\n      return minimatch(file, include, {dot: options.dot, matchBase: true});\n    });\n\n  const inExcludes = excludes.some(function iteratee(exclude) {\n    return minimatch(file, exclude, {dot: options.dot, matchBase: true});\n  });\n\n  return (isFalsey(includes) || not(isFile) || inIncludes) && not(inExcludes);\n};\n\nconst makeReplaceText = function makeReplaceText(options, canReplace) {\n  let lineCount = 0;\n  // The posix standard specifies that conforming sed implementations shall\n  // support at least 8192 byte line lengths.\n  const limit = 400; // chars per line\n  const regex = getRegExp(options);\n  let replaceFunc;\n\n  if (isStringType(options.funcFile)) {\n    // noinspection JSUnresolvedFunction\n    const funcString = fs.readFileSync(options.funcFile, options.encoding);\n    /* eslint-disable-next-line no-eval */\n    eval(`replaceFunc = ${funcString}`);\n  }\n\n  const print = function print(file, match) {\n    let printout = options.noColor ? file : file[options.fileColor] || file;\n\n    if (options.count) {\n      const count = ` (${match.length})`;\n      printout += options.noColor ? count : count.grey;\n    }\n\n    process.stdout.write(`${printout}\\n`);\n  };\n\n  const printer = function printer(line, index) {\n    if (line.match(regex)) {\n      lineCount += 1;\n\n      if (lineCount > options.maxLines) {\n        return true;\n      }\n\n      let replacement = String(options.replacement) || '$&';\n\n      if (isFalsey(options.noColor)) {\n        replacement = replacement[options.color];\n      }\n\n      const val = line.replace(regex, replaceFunc || replacement).slice(0, limit);\n      process.stdout.write(` ${index + 1}: ${val}\\n`);\n    }\n\n    return false;\n  };\n\n  return function replaceText(text, file) {\n    const match = text.match(regex);\n\n    if (isFalsey(match)) {\n      return null;\n    }\n\n    if (isFalsey(options.silent)) {\n      print(file, match);\n    }\n\n    if (isFalsey(options.silent) && isFalsey(options.quiet) && not(lineCount > options.maxLines) && options.multiline) {\n      text.split('\\n').some(printer);\n    }\n\n    return canReplace ? text.replace(regex, replaceFunc || String(options.replacement)) : undefined;\n  };\n};\n\nconst makeReplacefile = function makeReplacefile(options, canReplace, replacizeText) {\n  const rf = function replaceFile(file) {\n    fs.lstat(file, function lstat(error, stats) {\n      if (error) {\n        throw error;\n      }\n\n      if (stats.isSymbolicLink()) {\n        // don't follow symbolic links for now\n        return;\n      }\n\n      const isFile = stats.isFile();\n\n      if (not(canSearch(file, isFile, options))) {\n        return;\n      }\n\n      if (isFile) {\n        fs.readFile(file, options.encoding, function readFile(err, text) {\n          if (err) {\n            if (err.code === 'EMFILE') {\n              throw new Error('Too many files, try running `replace` without --async');\n            }\n\n            throw err;\n          }\n\n          const txt = replacizeText(text, file);\n\n          if (canReplace && not(isNull(txt))) {\n            fs.writeFile(file, txt, function writeFile(e) {\n              if (e) {\n                throw e;\n              }\n            });\n          }\n        });\n      } else if (stats.isDirectory() && options.recursive) {\n        fs.readdir(file, function cb(err, files) {\n          if (err) {\n            throw err;\n          }\n\n          files.forEach(function iteratee(f) {\n            rf(path.join(file, f));\n          });\n        });\n      }\n    });\n  };\n\n  return rf;\n};\n\nconst makeReplaceFileSync = function makeReplaceFileSync(options, canReplace, replaceText) {\n  const rfs = function replaceFileSync(file) {\n    const stats = fs.lstatSync(file);\n\n    if (stats.isSymbolicLink()) {\n      // don't follow symbolic links for now\n      return;\n    }\n\n    const isFile = stats.isFile();\n\n    if (not(canSearch(file, isFile, options))) {\n      return;\n    }\n\n    if (isFile) {\n      if (canReplace) {\n        const text = replaceText(fs.readFileSync(file, options.encoding), file);\n\n        if (isNull(text) === false) {\n          fs.writeFileSync(file, text);\n        }\n      }\n    } else if (stats.isDirectory() && options.recursive) {\n      fs.readdirSync(file).forEach(function readdirSync(f) {\n        rfs(path.join(file, f));\n      });\n    }\n  };\n\n  return rfs;\n};\n\nconst replace = function replace(options) {\n  const opts = {...options};\n  opts.paths = Array.isArray(opts.paths) ? opts.paths.slice() : sharedOptions.paths.default.slice();\n\n  // If the path is the same as the default and the recursive option was not\n  // specified, search recursively under the current directory as a\n  // convenience.\n  const pathSame = opts.paths.length === 1 && opts.paths[0] === sharedOptions.paths.default[0];\n\n  if (pathSame && not(hasOwnProp(opts, 'recursive'))) {\n    opts.paths = ['.'];\n    opts.recursive = true;\n  }\n\n  opts.encoding = sharedOptions.encoding.choices.includes(opts.encoding) ? opts.encoding : 'utf-8';\n  opts.color = sharedOptions.color.choices.includes(opts.color) ? opts.color : 'cyan';\n  opts.fileColor = sharedOptions.fileColor.choices.includes(opts.fileColor) ? opts.fileColor : 'yellow';\n  const canReplace = isFalsey(opts.preview) && not(isUndefined(opts.replacement));\n  const replaceText = makeReplaceText(opts, canReplace);\n  const replaceFile = makeReplacefile(opts, canReplace, replaceText);\n  const replaceFileSync = makeReplaceFileSync(opts, canReplace, replaceText);\n\n  opts.paths.forEach(function iteratee(p) {\n    if (opts.async) {\n      replaceFile(p);\n    } else {\n      replaceFileSync(p);\n    }\n  });\n};\n\nexport default replace;\n"]}